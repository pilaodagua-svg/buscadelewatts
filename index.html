<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BovinoTech Santiago</title>
    <style>
        :root { --primary: #2e7d32; --alert: #d32f2f; --bg: #f1f8e9; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        
        .container { max-width: 600px; margin: auto; }
        
        /* Cabe√ßalho */
        header { text-align: center; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h1 { color: var(--primary); margin: 0; font-size: 1.8rem; }
        .subtitle { color: #666; font-size: 0.9rem; margin-top: 5px; }

        /* Bot√µes */
        .btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; transition: 0.3s; }
        .btn-add { background: var(--primary); color: white; box-shadow: 0 4px 0 #1b5e20; }
        .btn-add:active { transform: translateY(4px); box-shadow: none; }
        
        /* Cart√£o do Animal */
        .card { background: white; border-radius: 12px; overflow: hidden; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: relative; }
        .card img { width: 100%; height: 250px; object-fit: cover; }
        
        .card-body { padding: 15px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .price { font-size: 1.4rem; color: var(--primary); font-weight: 800; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #f9f9f9; padding: 10px; border-radius: 8px; font-size: 0.9rem; }
        
        /* Estilos para Veterin√°rios */
        .vet-badge { background: #e3f2fd; color: #1565c0; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; text-transform: uppercase; }
        .status-sick { background: #ffebee; color: #c62828; } /* Vermelho para doentes */
        .status-healthy { background: #e8f5e9; color: #2e7d32; } /* Verde para saud√°veis */

        .btn-vet { background: #fff; border: 2px solid #1565c0; color: #1565c0; margin-top: 10px; padding: 8px; }
        .btn-vet:hover { background: #e3f2fd; }

    </style>
</head>
<body>

<div class="container">
    
    <header>
        <h1>üêÆ BovinoTech Santiago</h1>
        <p class="subtitle">Conectando Produtores e Veterin√°rios no RS</p>
        <div style="text-align: left; font-size: 0.9rem; margin-top: 15px; color: #555;">
            <p>‚úÖ <strong>Para o Produtor:</strong> Calcule o peso do gado apenas com uma fita m√©trica e anuncie para a regi√£o.</p>
            <p>‚úÖ <strong>Para o Veterin√°rio:</strong> Acompanhe o rebanho e use a calculadora autom√°tica de dosagem.</p>
        </div>

        <a href="https://docs.google.com/spreadsheets/d/1siJAnVoA3KwnoQWYtkB-wODIb1j1_YP2VHC-djXnFtg/edit?usp=sharing" target="_blank" class="btn btn-add">
            ‚ûï Anunciar Animal (Preencher Ficha)
        </a>
    </header>

    <div id="feed">
        <p style="text-align:center; color:#777;">Carregando rebanho...</p>
    </div>

</div>

<script>
    // ‚ö†Ô∏è IMPORTANTE: Cole seu link CSV do Google Sheets aqui (File > Share > Publish to Web > CSV)
    const SHEET_URL = https://docs.google.com/spreadsheets/d/1siJAnVoA3KwnoQWYtkB-wODIb1j1_YP2VHC-djXnFtg/edit?usp=drivesdk ;
    async function loadCows() {
        try {
            const response = await fetch(SHEET_URL);
            const data = await response.text();
            const rows = data.split('\n').slice(1); // Ignora o cabe√ßalho
            
            const feed = document.getElementById('feed');
            feed.innerHTML = '';

            rows.forEach(row => {
                // Dividir colunas (CSV simples)
                const cols = row.split(',');
                if (cols.length < 5) return;

                // Mapeamento das Colunas (Ajuste conforme seu Google Sheets)
                // 0=Data, 1=Foto, 2=Pre√ßo, 3=Peito(cm), 4=Comprimento(cm), 5=Coords, 6=Sa√∫de
                const photo = cols[1];
                const price = cols[2];
                const girthCm = parseFloat(cols[3]);
                const lenCm = parseFloat(cols[4]);
                const coords = cols[5];
                const health = cols[6] ? cols[6].trim() : "Saud√°vel";

                // üßÆ C√ÅLCULO DE PESO (F√≥rmula Schaeffer Adaptada para CM)
                // Peso (kg) = (Peito^2 x Comprimento) / 11900 (Constante m√©dia para gado de corte)
                let weightKg = 0;
                if(girthCm && lenCm) {
                    weightKg = ((Math.pow(girthCm, 2) * lenCm) / 11900).toFixed(1);
                }

                // Estilo baseado na sa√∫de
                const statusClass = health.toLowerCase().includes('doente') ? 'status-sick' : 'status-healthy';

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <img src="${photo}" onerror="this.src='https://via.placeholder.com/400?text=Sem+Foto'">
                    
                    <div class="card-body">
                        <div class="card-header">
                            <span class="price">R$ ${price}</span>
                            <span class="vet-badge ${statusClass}">${health}</span>
                        </div>

                        <div class="stats-grid">
                            <div><strong>‚öñÔ∏è Peso Est.:</strong><br> ${weightKg} kg</div>
                            <div><strong>üìè Medidas:</strong><br> ${girthCm} x ${lenCm} cm</div>
                        </div>

                        <button class="btn btn-vet" onclick="calcDose(${weightKg})">
                            üíâ Vet: Calcular Dosagem
                        </button>

                        <a href="https://www.google.com/maps/search/?api=1&query=${coords}" target="_blank" class="btn" style="background:#f0f0f0; color:#333; margin-top:5px;">
                            üìç Ver Localiza√ß√£o no Mapa
                        </a>
                    </div>
                `;
                feed.prepend(card);
            });
        } catch (error) {
            document.getElementById('feed').innerHTML = '<p style="text-align:center; color:red">Erro ao carregar dados. Verifique o link da planilha.</p>';
        }
    }

    // üíâ Fun√ß√£o para Veterin√°rios
    function calcDose(weight) {
        if(weight <= 0) {
            alert("Peso inv√°lido para c√°lculo.");
            return;
        }
        // Pergunta a dosagem da bula
        let dosePerKg = prompt(`O peso estimado √© ${weight} kg.\n\nQual a dose recomendada em ml por kg? (Ex: Digite 0.05 para 1ml/20kg)`);
        
        if(dosePerKg) {
            dosePerKg = parseFloat(dosePerKg.replace(',', '.')); // Aceita v√≠rgula ou ponto
            let totalDose = (weight * dosePerKg).toFixed(2);
            alert(`üìã RECEITA SUGERIDA:\n\nPara um animal de ${weight} kg:\nAdministrar üëâ ${totalDose} ml üëà do medicamento.`);
        }
    }

    loadCows();
</script>

</body>
</html>
